angular.module("dialogService",[]).service("dialogService",["$rootScope","$q","$compile","$templateCache","$http",function(m,f,n,e,p){function k(a){var c=g.dialogs[a];if(!angular.isDefined(c))throw"DialogService does not have a reference to dialog id "+a;return c}function l(a){return a?a.replace(/^\s+|\s+$/g,""):a}function q(a){var c=f.defer(),b=e.get(a);if(angular.isDefined(b))b=l(b),c.resolve(b);else return p.get(a,{cache:e}).then(function(b){b=b.data;if(!b||!b.length)return f.reject("Template "+
a+" was not found");b=l(b);e.put(a,b);return b},function(){return f.reject("Template "+a+" was not found")});return c.promise}var g=this;g.dialogs={};this.open=function(a,c,b,e){if(!angular.isDefined(a))throw"dialogService requires id in call to open";if(!angular.isDefined(c))throw"dialogService requires template in call to open";angular.isDefined(b)||(b=null);var h={};angular.isDefined(e)&&angular.extend(h,e);var d={scope:null,ref:null,deferred:f.defer()};q(c).then(function(c){d.scope=m.$new();d.scope.model=
b;c=n(c);d.ref=$(c(d.scope));var e=h.close;h.close=function(b,c){e&&e(b,c);var d=k(a);d.deferred.reject();d.scope.$destroy();d.ref.remove();delete g.dialogs[a]};d.ref.dialog(h);d.ref.dialog("open");g.dialogs[a]=d},function(a){throw a;});return d.deferred.promise};this.close=function(a,c){var b=k(a);b.deferred.resolve(c);b.ref.dialog("close")};this.cancel=function(a){a=k(a);a.deferred.reject();a.ref.dialog("close")}}]);
